$(function(){function e(){var e=t.basicFee;1==$("#Registration_has_entourage").val()&&(e+=t.entourageFee),$(".registration-events:checked").each(function(){e+=$(this).data("fee")}),t.multiCountries&&(e=$("#Registration_location_id option:selected").data("fee")),e&&0!=e?n.removeClass("hide").find("#totalFee").html(e):n.addClass("hide")}var t=window.registrationOptions,n=(t.regulations,$("#fee"));$(document).on("change",".registration-agreements",function(){var e=!0;$(".registration-agreements").each(function(){e=e&&this.checked}),$("#submit-button").prop("disabled",!e)}).on("change",".registration-events, #Registration_location_id",function(){e()}).on("change","#Registration_has_entourage",function(){$(".entourage-info")[1==this.value?"removeClass":"addClass"]("hide"),e()}).on("change","#Registration_staff_type",function(){$(".staff-info")[this.value>0?"removeClass":"addClass"]("hide"),e()}).on("click","#submit-button",function(e){var n=$(".registration-events:checked"),a=[];if(n.each(function(){var e=$(this).val();t.unmetEvents[e]&&a.push(e)}),t.showRegulations||a.length>0){e.preventDefault();var i={};n.each(function(){var e=$(this).val();switch(e){case"333ft":case"clock":i[e]=!0;break;case"333bf":i.bf=!0;break;case"444bf":case"555bf":i.bf=!0,i.lbf=!0,i.bbf=!0;break;case"333mbf":i.bf=!0,i.lbf=!0}});var s=[];if(a.length>0&&(s.push(t.unmetEventsMessage),s.push("\n"),s.push(a.map(function(e){return $(".event-icon-"+e).attr("title")}).join(t.delimiter)),s.push("<hr>")),t.showRegulations){var o=$("<ol>");t.regulations.common.forEach(function(e){o.append($("<li>").html(e))}),$.each(t.regulations.special,function(e,t){i[e]&&o.append($("<li>").html(t))}),s.push("<h4>"+t.regulationDesc+"</h4>"),s.push($("<div>").append(o).html())}CubingChina.utils.confirm(s,{type:"type-warning"}).then(function(){$("#registration-form").submit()})}}),$(".registration-events").trigger("change"),$("#Registration_has_entourage").trigger("change"),$("#Registration_staff_type").trigger("change"),$.each(t.unmetEvents,function(e,t){$('.registration-events[value="'+e+'"]').parent().addClass("bg-danger").data("qualifyingTime",t)})});